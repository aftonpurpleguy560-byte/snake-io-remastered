<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Snake.io Pro - Purpleguy</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #000; color: white; font-family: sans-serif; }
        canvas { display: block; touch-action: none; }
        
        /* Arayüz Elemanları */
        .ui-panel { position: absolute; z-index: 10; pointer-events: none; }
        #leaderboard { top: 20px; right: 20px; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 8px; border: 1px solid #444; min-width: 150px; }
        #score-board { top: 20px; left: 20px; font-size: 24px; font-weight: bold; color: #A020F0; }
        #minimap-container { bottom: 20px; right: 20px; width: 120px; height: 120px; background: rgba(255,255,255,0.1); border: 2px solid #555; border-radius: 10px; }

        /* Menü ve Ölüm Ekranı */
        .overlay { position: absolute; top:0; left:0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; background: rgba(0,0,0,0.85); }
        .btn { padding: 12px 30px; border-radius: 20px; border: none; background: #A020F0; color: white; font-weight: bold; cursor: pointer; margin: 10px; pointer-events: auto; }
        
        /* Kontroller */
        #joy-base { position: absolute; bottom: 40px; left: 40px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%; z-index: 20; }
        #joy-stick { position: absolute; width: 40px; height: 40px; background: #A020F0; border-radius: 50%; top: 30px; left: 30px; }
        #boost-btn { position: absolute; bottom: 45px; right: 160px; width: 70px; height: 70px; background: rgba(160,32,240,0.4); border: 2px solid #A020F0; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 20; pointer-events: auto; font-size: 12px; }

        .footer { position: absolute; bottom: 10px; width: 100%; text-align: center; font-size: 10px; color: #666; }
    </style>
</head>
<body>

    <div id="score-board" class="ui-panel">Skor: 0</div>
    
    <div id="leaderboard" class="ui-panel">
        <div style="text-align: center; border-bottom: 1px solid #666; margin-bottom: 5px; font-size: 12px;">SIRALAMA</div>
        <div id="leader-list"></div>
    </div>

    <div id="minimap-container" class="ui-panel">
        <canvas id="minimap" width="120" height="120"></canvas>
    </div>

    <div id="menu" class="overlay">
        <h1 style="color:#A020F0; text-shadow: 0 0 10px #A020F0;">Snake.io Pro</h1>
        <button class="btn" onclick="startGame()">OYUNA BAŞLA</button>
        <div class="footer">Purpleguy © 2026 - tablet power</div>
    </div>

    <div id="death-screen" class="overlay" style="display:none;">
        <h1 style="color:red;">ÖLDÜN!</h1>
        <p id="final-score"></p>
        <button class="btn" onclick="location.reload()">TEKRAR DENE</button>
    </div>

    <div id="joy-base"><div id="joy-stick"></div></div>
    <div id="boost-btn">BOOST</div>
    <canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const mCanvas = document.getElementById('minimap');
const mCtx = mCanvas.getContext('2d');

let world = { w: 3000, h: 3000 };
let snake = { x: 1500, y: 1500, angle: 0, segments: [], len: 20, speed: 4 };
let foods = [];
let bots = [];
let gameActive = false;
let isBoosting = false;

// Başlatma
function init() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    for(let i=0; i<400; i++) spawnFood();
    for(let i=0; i<15; i++) spawnBot();
}

function spawnFood() {
    foods.push({x: Math.random()*world.w, y: Math.random()*world.h, c: `hsl(${Math.random()*360}, 80%, 50%)`, r: 4});
}

function spawnBot() {
    bots.push({
        x: Math.random()*world.w, y: Math.random()*world.h,
        angle: Math.random()*Math.PI*2, segments: [], len: 20 + Math.random()*40,
        c: `hsl(${Math.random()*360}, 70%, 50%)`, name: "Bot_" + Math.floor(Math.random()*100)
    });
}

// Kontroller
const stick = document.getElementById('joy-stick');
window.addEventListener('touchmove', (e) => {
    if(!gameActive) return;
    const t = e.touches[0];
    const dx = t.clientX - 90; const dy = t.clientY - (window.innerHeight - 90);
    snake.angle = Math.atan2(dy, dx);
    const dist = Math.min(Math.hypot(dx, dy), 30);
    stick.style.transform = `translate(${Math.cos(snake.angle)*dist}px, ${Math.sin(snake.angle)*dist}px)`;
});

document.getElementById('boost-btn').addEventListener('touchstart', () => isBoosting = true);
document.getElementById('boost-btn').addEventListener('touchend', () => isBoosting = false);

function update() {
    if(!gameActive) return;

    let s = isBoosting && snake.len > 10 ? 8 : 4;
    snake.x += Math.cos(snake.angle) * s;
    snake.y += Math.sin(snake.angle) * s;

    snake.segments.unshift({x: snake.x, y: snake.y});
    if(snake.segments.length > snake.len) snake.segments.pop();

    // Sınır ve Bot Çarpışma
    if(snake.x < 0 || snake.x > world.w || snake.y < 0 || snake.y > world.h) endGame();
    
    // Yemek
    foods.forEach((f, i) => {
        if(Math.hypot(snake.x - f.x, snake.y - f.y) < 20) {
            snake.len += 1; foods.splice(i, 1); spawnFood();
        }
    });

    // Bot Hareketi
    bots.forEach(b => {
        b.x += Math.cos(b.angle)*3; b.y += Math.sin(b.angle)*3;
        b.segments.unshift({x:b.x, y:b.y});
        if(b.segments.length > b.len) b.segments.pop();
        if(b.x < 0 || b.x > world.w || b.y < 0 || b.y > world.h) b.angle += Math.PI;
    });
}

function draw() {
    ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width, canvas.height);
    
    ctx.save();
    ctx.translate(canvas.width/2 - snake.x, canvas.height/2 - snake.y);

    // Yemek
    foods.forEach(f => {
        ctx.fillStyle = f.c; ctx.beginPath(); ctx.arc(f.x, f.y, f.r, 0, Math.PI*2); ctx.fill();
    });

    // Botlar
    bots.forEach(b => {
        ctx.fillStyle = b.c;
        b.segments.forEach(seg => {
            ctx.beginPath(); ctx.arc(seg.x, seg.y, 12, 0, Math.PI*2); ctx.fill();
        });
    });

    // Oyuncu
    ctx.fillStyle = '#A020F0';
    snake.segments.forEach((seg, i) => {
        ctx.beginPath(); ctx.arc(seg.x, seg.y, 14, 0, Math.PI*2); ctx.fill();
        if(i === 0) { // Gözler
            ctx.fillStyle = "white";
            ctx.beginPath(); ctx.arc(seg.x+5, seg.y-5, 4, 0, Math.PI*2); ctx.fill();
        }
    });

    ctx.restore();
    
    // UI Güncelleme
    document.getElementById('score-board').innerText = "Skor: " + Math.floor(snake.len * 10);
    drawMinimap();
}

function drawMinimap() {
    mCtx.clearRect(0,0,120,120);
    mCtx.fillStyle = "red";
    mCtx.fillRect((snake.x/world.w)*120, (snake.y/world.h)*120, 4, 4);
}

function startGame() {
    document.getElementById('menu').style.display = 'none';
    gameActive = true;
    init();
}

function endGame() {
    gameActive = false;
    document.getElementById('final-score').innerText = "Skorun: " + Math.floor(snake.len * 10);
    document.getElementById('death-screen').style.display = 'flex';
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
